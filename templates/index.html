<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Face Recognition Attendance System</title>

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#4f46e5">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Attendance System">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  
  <!-- Favicon and PWA Icons -->
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='icon-192x192.png') }}">

  <!-- Bootstrap 5.3.3 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Animate.css for animations -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- AOS (Animate On Scroll) Library -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    /* Enhanced Background with New Animations */
    .bg-image {
      background-size: 400% 400%;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      transition: all 1s ease-in-out;
      animation: gradientShift 15s ease-in-out infinite, backgroundPulse 8s ease-in-out infinite;
      overflow: hidden;
    }

    /* New Advanced Gradient Animation */
    @keyframes gradientShift {
      0% {
        background-position: 0% 50%;
        filter: hue-rotate(0deg);
      }

      25% {
        background-position: 100% 50%;
        filter: hue-rotate(90deg);
      }

      50% {
        background-position: 100% 100%;
        filter: hue-rotate(180deg);
      }

      75% {
        background-position: 0% 100%;
        filter: hue-rotate(270deg);
      }

      100% {
        background-position: 0% 50%;
        filter: hue-rotate(360deg);
      }
    }

    /* New Pulse Animation */
    @keyframes backgroundPulse {

      0%,
      100% {
        transform: scale(1);
        opacity: 1;
      }

      50% {
        transform: scale(1.02);
        opacity: 0.95;
      }
    }

    /* Floating Geometric Shapes */
    .bg-image::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image:
        radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 40% 60%, rgba(255, 255, 255, 0.06) 0%, transparent 50%),
        radial-gradient(circle at 60% 40%, rgba(255, 255, 255, 0.04) 0%, transparent 50%);
      background-size: 200px 200px, 150px 150px, 300px 300px, 250px 250px;
      animation: floatingShapes 20s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes floatingShapes {

      0%,
      100% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 0.8;
      }

      25% {
        transform: translate(20px, -30px) rotate(90deg);
        opacity: 1;
      }

      50% {
        transform: translate(-10px, -20px) rotate(180deg);
        opacity: 0.6;
      }

      75% {
        transform: translate(-30px, 10px) rotate(270deg);
        opacity: 0.9;
      }
    }

    /* Teacher-specific animated background */
    .teacher-bg {
      background: linear-gradient(-45deg, #667eea, #764ba2, #f093fb, #f5576c);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      position: relative;
    }

    .teacher-bg::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image:
        radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(120, 119, 255, 0.3) 0%, transparent 50%);
      animation: float 20s ease-in-out infinite;
    }

    .teacher-bg::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image:
        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><defs><radialGradient id="a" cx="50%" cy="50%"><stop offset="0%" style="stop-color:rgba(255,255,255,0.1)"/><stop offset="100%" style="stop-color:rgba(255,255,255,0)"/></radialGradient></defs><circle cx="200" cy="200" r="100" fill="url(%23a)"/><circle cx="800" cy="300" r="150" fill="url(%23a)"/><circle cx="300" cy="700" r="120" fill="url(%23a)"/><circle cx="700" cy="800" r="80" fill="url(%23a)"/></svg>');
      background-size: 1000px 1000px;
      animation: drift 30s linear infinite;
      opacity: 0.6;
    }

    @keyframes gradientBG {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px) rotate(0deg);
      }

      33% {
        transform: translateY(-30px) rotate(120deg);
      }

      66% {
        transform: translateY(30px) rotate(240deg);
      }
    }

    @keyframes drift {
      0% {
        transform: translateX(-100px) translateY(-100px);
      }

      100% {
        transform: translateX(100px) translateY(100px);
      }
    }

    /* Animated particles for teacher background */
    .teacher-particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 1;
    }

    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      animation: particleFloat 20s infinite linear;
    }

    .particle:nth-child(odd) {
      background: rgba(255, 182, 193, 0.8);
      animation-duration: 25s;
    }

    .particle:nth-child(3n) {
      background: rgba(173, 216, 230, 0.8);
      animation-duration: 30s;
    }

    @keyframes particleFloat {
      0% {
        transform: translateY(100vh) translateX(0px) rotate(0deg);
        opacity: 0;
      }

      10% {
        opacity: 1;
      }

      90% {
        opacity: 1;
      }

      100% {
        transform: translateY(-100vh) translateX(100px) rotate(360deg);
        opacity: 0;
      }
    }

    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.2);
      z-index: 0;
      animation: overlayPulse 8s ease-in-out infinite;
    }

    @keyframes overlayPulse {

      0%,
      100% {
        background: rgba(0, 0, 0, 0.2);
      }

      50% {
        background: rgba(0, 0, 0, 0.1);
      }
    }

    /* Teacher-specific overlay */
    .teacher-overlay {
      background: rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(1px);
    }

    /* Enhanced Modern Container */
    .container {
      position: relative;
      z-index: 1;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      padding: 3rem 2rem;
      border-radius: 25px;
      text-align: center;
      max-width: 650px;
      box-shadow:
        0 25px 50px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(255, 255, 255, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
      animation: containerFloat 6s ease-in-out infinite, containerGlow 4s ease-in-out infinite;
      transform-style: preserve-3d;
    }

    /* New Floating Animation */
    @keyframes containerFloat {

      0%,
      100% {
        transform: translateY(0px) rotateX(0deg) rotateY(0deg);
        box-shadow:
          0 25px 50px rgba(0, 0, 0, 0.3),
          0 0 0 1px rgba(255, 255, 255, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.3);
      }

      33% {
        transform: translateY(-15px) rotateX(2deg) rotateY(-1deg);
        box-shadow:
          0 35px 70px rgba(0, 0, 0, 0.4),
          0 0 0 1px rgba(255, 255, 255, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.4);
      }

      66% {
        transform: translateY(-10px) rotateX(-1deg) rotateY(2deg);
        box-shadow:
          0 30px 60px rgba(0, 0, 0, 0.35),
          0 0 0 1px rgba(255, 255, 255, 0.25),
          inset 0 1px 0 rgba(255, 255, 255, 0.35);
      }
    }

    /* New Glow Animation */
    @keyframes containerGlow {

      0%,
      100% {
        filter: brightness(1) saturate(1);
      }

      50% {
        filter: brightness(1.1) saturate(1.2);
      }
    }

    /* Enhanced Title Animations */
    .container h1 {
      background: linear-gradient(45deg, #667eea, #764ba2, #667eea);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: titleGradient 3s ease-in-out infinite, titleBounce 2s ease-in-out infinite;
      font-weight: 700;
      margin-bottom: 2rem;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    @keyframes titleGradient {

      0%,
      100% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }
    }

    @keyframes titleBounce {

      0%,
      100% {
        transform: translateY(0px) scale(1);
      }

      50% {
        transform: translateY(-5px) scale(1.02);
      }
    }

    /* Enhanced Button Styles */
    .btn {
      position: relative;
      overflow: hidden;
      border-radius: 15px;
      font-weight: 600;
      padding: 0.8rem 2rem;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
      backdrop-filter: blur(10px);
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      color: white;
      animation: buttonPulse 3s ease-in-out infinite;
    }

    .btn-success {
      background: linear-gradient(135deg, #11998e, #38ef7d);
      border: none;
      color: white;
    }

    .btn-warning {
      background: linear-gradient(135deg, #f093fb, #f5576c);
      border: none;
      color: white;
    }

    .btn-info {
      background: linear-gradient(135deg, #4facfe, #00f2fe);
      border: none;
      color: white;
    }

    @keyframes buttonPulse {

      0%,
      100% {
        box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.4);
      }

      50% {
        box-shadow: 0 0 0 20px rgba(102, 126, 234, 0);
      }
    }

    /* Enhanced container for teachers */
    .teacher-container {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
      animation: containerPulse 4s ease-in-out infinite;
    }

    @keyframes containerPulse {

      0%,
      100% {
        transform: scale(1);
        box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
      }

      50% {
        transform: scale(1.02);
        box-shadow: 0 30px 60px rgba(0, 0, 0, 0.15);
      }
    }

    .teacher-title {
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      animation: titleGlow 3s ease-in-out infinite alternate;
    }

    @keyframes titleGlow {
      0% {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      100% {
        text-shadow: 0 0 20px rgba(255, 255, 255, 0.8), 2px 2px 4px rgba(0, 0, 0, 0.3);
      }
    }

    .teacher-nav-btn {
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid rgba(255, 255, 255, 0.3);
      color: white;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .teacher-nav-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .teacher-nav-btn:hover::before {
      left: 100%;
    }

    .teacher-nav-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      color: white;
      text-decoration: none;
    }

    h1 {
      font-weight: bold;
      color: #003366;
      margin-bottom: 30px;
      opacity: 0.95;
    }

    nav a {
      margin: 10px;
      min-width: 180px;
      opacity: 0.9;
    }

    nav a:hover {
      opacity: 1;
    }

    /* Calendar Widget Styles */
    .calendar-floating-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
      font-size: 1.5rem;
      color: white;
      text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }

    .calendar-floating-btn:hover {
      background: rgba(255, 255, 255, 0.4);
      transform: scale(1.1);
      box-shadow: 0 5px 20px rgba(255, 255, 255, 0.3);
    }

    .calendar-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      width: 90%;
      max-width: 900px;
      max-height: 80vh;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      z-index: 1001;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      overflow-y: auto;
    }

    .calendar-popup.show {
      transform: translate(-50%, -50%) scale(1);
    }

    .calendar-popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .calendar-popup-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .calendar-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 20px 20px 0 0;
      text-align: center;
      position: relative;
    }

    .close-calendar {
      position: absolute;
      top: 15px;
      right: 20px;
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s;
    }

    .close-calendar:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    .calendar-content {
      padding: 20px;
    }

    .year-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .year-nav-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .year-nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .month-card {
      background: #f8f9fa;
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s;
    }

    .month-card:hover {
      transform: translateY(-3px);
    }

    .month-header {
      text-align: center;
      font-weight: bold;
      margin-bottom: 10px;
      color: #333;
      font-size: 1.1rem;
    }

    .days-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 2px;
    }

    .day-header {
      text-align: center;
      font-weight: bold;
      padding: 5px;
      background-color: #e9ecef;
      color: #495057;
      font-size: 0.8rem;
      border-radius: 3px;
    }

    .calendar-day {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
    }

    .calendar-day:hover {
      background-color: #e3f2fd;
      transform: scale(1.1);
    }

    .calendar-day.today {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-weight: bold;
    }

    .calendar-day.holiday {
      background-color: #ffebee;
      color: #c62828;
      font-weight: bold;
    }

    .calendar-day.holiday.national {
      background-color: #e8f5e8;
      color: #2e7d32;
    }

    .calendar-day.holiday.religious {
      background-color: #e3f2fd;
      color: #1565c0;
    }

    .calendar-day.holiday.festival {
      background-color: #fff3e0;
      color: #ef6c00;
    }

    .holiday-indicator {
      position: absolute;
      top: 2px;
      right: 2px;
      width: 4px;
      height: 4px;
      background-color: #ff4444;
      border-radius: 50%;
    }

    .holidays-section {
      margin-top: 20px;
      border-top: 2px solid #f0f0f0;
      padding-top: 20px;
    }

    .holidays-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 20px;
    }

    .holiday-list {
      max-height: 300px;
      overflow-y: auto;
    }

    .holiday-group {
      margin-bottom: 20px;
    }

    .holiday-type-header {
      font-weight: bold;
      margin-bottom: 10px;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 0.9rem;
    }

    .holiday-type-header.national {
      background-color: #e8f5e8;
      color: #2e7d32;
    }

    .holiday-type-header.religious {
      background-color: #e3f2fd;
      color: #1565c0;
    }

    .holiday-type-header.festival {
      background-color: #fff3e0;
      color: #ef6c00;
    }

    .holiday-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      margin: 5px 0;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #ddd;
      transition: all 0.2s;
    }

    .holiday-item:hover {
      background: #e9ecef;
      transform: translateX(5px);
    }

    .holiday-item.national {
      border-left-color: #4caf50;
    }

    .holiday-item.religious {
      border-left-color: #2196f3;
    }

    .holiday-item.festival {
      border-left-color: #ff9800;
    }

    .holiday-summary {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
    }

    .summary-stat {
      margin-bottom: 15px;
    }

    .summary-number {
      font-size: 2rem;
      font-weight: bold;
      color: #667eea;
    }

    .summary-label {
      font-size: 0.9rem;
      color: #666;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .calendar-popup {
        width: 95%;
        max-height: 90vh;
      }

      .holidays-grid {
        grid-template-columns: 1fr;
      }

      .calendar-grid {
        grid-template-columns: 1fr;
      }
    }

    .chatbot-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      color: white;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 25px;
      text-decoration: none;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      transition: all 0.3s ease;
      z-index: 1000;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .chatbot-button:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
      color: white;
      text-decoration: none;
    }

    .chatbot-button:active {
      transform: translateY(0) scale(0.98);
    }

    /* PWA Install Button Styles */
    .pwa-install-banner {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 12px 20px;
      border-radius: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      z-index: 1000;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transform: translateX(100%);
      transition: all 0.3s ease;
      display: none;
    }
    
    .pwa-install-banner.show {
      display: block;
      transform: translateX(0);
    }
    
    .pwa-install-banner:hover {
      transform: translateX(0) scale(1.05);
      box-shadow: 0 6px 25px rgba(0,0,0,0.3);
    }
    
    .pwa-install-banner .close-btn {
      margin-left: 10px;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      cursor: pointer;
      font-size: 12px;
    }
  </style>
</head>

<body>
  <!-- Calendar Floating Button -->
  <div class="calendar-floating-btn" onclick="toggleCalendar()">
    📅
  </div>

  <!-- Calendar Popup Overlay -->
  <div class="calendar-popup-overlay" id="calendarOverlay" onclick="closeCalendar()"></div>

  <!-- Calendar Popup -->
  <div class="calendar-popup" id="calendarPopup">
    <div class="calendar-header">
      <button class="close-calendar" onclick="closeCalendar()">×</button>
      <h3>📅 Yearly Calendar with Holidays</h3>
      <div class="year-navigation">
        <button class="year-nav-btn" onclick="changeYear(-1)">
          ← Previous Year
        </button>
        <h4 id="currentYear">2025</h4>
        <button class="year-nav-btn" onclick="changeYear(1)">
          Next Year →
        </button>
      </div>
    </div>

    <div class="calendar-content">
      <!-- Calendar Grid -->
      <div class="calendar-grid" id="calendarGrid">
        <!-- Calendar months will be generated by JavaScript -->
      </div>

      <!-- Holidays Section -->
      <div class="holidays-section">
        <h5>🎉 Holidays for <span id="holidayYear">2025</span></h5>
        <div class="holidays-grid">
          <div class="holiday-list" id="holidaysList">
            <!-- Holidays will be populated by JavaScript -->
          </div>
          <div class="holiday-summary">
            <h6>📊 Holiday Summary</h6>
            <div id="holidaySummary">
              <!-- Summary stats will be shown here -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Conditional Background Image -->
  <!-- Dynamic Background for Different User Types -->
  <div class="bg-image {% if session.get('teacher_logged_in') %}teacher-bg{% else %}{% endif %}" style="
  {% if not session.get('teacher_logged_in') %}
  {% if session.get('logged_in') %}
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  {% else %}
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  {% endif %}
  {% endif %}
">
    <!-- Animated particles for teacher background -->
    {% if session.get('teacher_logged_in') %}
    <div class="teacher-particles" id="teacherParticles"></div>
    {% endif %}

    <div class="overlay {% if session.get('teacher_logged_in') %}teacher-overlay{% endif %}"></div>

    <!-- PWA Install Banner -->
    <div id="pwaInstallBanner" class="pwa-install-banner">
      <i class="fas fa-download"></i> Install App for Quick Access
      <button class="close-btn" onclick="closePwaInstallBanner()">×</button>
    </div>

    <!-- Content -->
    <div
      class="container animate__animated animate__fadeIn {% if session.get('teacher_logged_in') %}teacher-container{% endif %}">
      {% if session.get('teacher_logged_in') %}
      <h1 class="teacher-title">👨‍🏫 Welcome to Teacher Dashboard</h1>
      {% elif not session.get('logged_in') %}
      <h1>🎯 Your Face is Your ID: Welcome to Attendance System</h1>
      {% else %}
      <h1>👨‍💼 Admin Dashboard: Manage Attendance & Users</h1>
      {% endif %}
      <nav>
        {% if not session.get('logged_in') and not session.get('teacher_logged_in') and not session.get('student_id') %}
        <!-- Show on home page (no one logged in) -->
        <a href="/register" class="btn btn-success btn-lg me-2">
          <i class="fas fa-user-plus me-2"></i>Register User
        </a>
        <a href="/checkin" class="btn btn-primary btn-lg me-2">
          <i class="fas fa-sign-in-alt me-2"></i>Check-in
        </a>
        <a href="/checkout" class="btn btn-info btn-lg">
          <i class="fas fa-sign-out-alt me-2"></i>Check-out
        </a>
        {% endif %}

        <!-- Admin View -->
        {% if session.get('logged_in') %}
        <a href="/dashboard" class="btn btn-warning btn-lg me-2">
          <i class="fas fa-chart-line me-2"></i>View Attendance Records
        </a>
        <a href="{{ url_for('show_students') }}" class="btn btn-info btn-lg me-2">
          <i class="fas fa-users me-2"></i>All Students
        </a>
        <a href="/logout" class="btn btn-danger btn-lg">
          <i class="fas fa-sign-out-alt me-2"></i>Logout (Admin)
        </a>

        <!-- Teacher View -->
        {% elif session.get('teacher_logged_in') %}
        <a href="/teacher_dashboard" class="btn teacher-nav-btn btn-lg me-2">
          <i class="fas fa-chalkboard-teacher me-2"></i>Teacher Dashboard
        </a>
        <a href="/teacher_logout" class="btn teacher-nav-btn btn-lg">
          <i class="fas fa-sign-out-alt me-2"></i>Logout
        </a>

        <!-- Student View -->
        {% elif session.get('student_id') %}
        <a href="/student_dashboard" class="btn btn-info btn-lg me-2">
          <i class="fas fa-tachometer-alt me-2"></i>Student Dashboard
        </a>
        <a href="/profile" class="btn btn-outline-primary btn-lg me-2">
          <i class="fas fa-user me-2"></i>View Profile
        </a>
        <a href="/edit_profile" class="btn btn-outline-warning btn-lg me-2">
          <i class="fas fa-edit me-2"></i>Edit Profile
        </a>
        <a href="/logout" class="btn btn-danger btn-lg">
          <i class="fas fa-sign-out-alt me-2"></i>Logout (Student)
        </a>

        <!-- Guest View -->
        {% else %}
        <a href="/login" class="btn btn-secondary btn-lg me-2">
          <i class="fas fa-user-shield me-2"></i>Admin Login
        </a>
        <a href="/teacher_login" class="btn btn-dark btn-lg me-2">
          <i class="fas fa-chalkboard-teacher me-2"></i>Teacher Login
        </a>
        <a href="/student_login" class="btn btn-outline-success btn-lg">
          <i class="fas fa-user-graduate me-2"></i>Student Login
        </a>
        {% endif %}
      </nav>

    </div>
    
  </div>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    function sendMessage() {
      const userInput = document.getElementById("userInput").value;
      if (!userInput.trim()) return;

      const chatlog = document.getElementById("chatlog");
      chatlog.innerHTML += `<div><b>You:</b> ${userInput}</div>`;

      fetch("/chatbot", {
        method: "POST",
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ message: userInput })
      })
        .then(res => res.json())
        .then data => {
          chatlog.innerHTML += `<div><b>Bot:</b> ${data.response}</div>`;
          document.getElementById("userInput").value = "";
          chatlog.scrollTop = chatlog.scrollHeight;
        });
    }

    // Calendar functionality
    let currentYear = new Date().getFullYear();

    // Holiday data
    const holidays = {
      2025: [
        { date: '2025-01-01', name: 'New Year\'s Day', reason: 'National Holiday', type: 'national' },
        { date: '2025-01-26', name: 'Republic Day', reason: 'National Holiday', type: 'national' },
        { date: '2025-03-14', name: 'Holi', reason: 'Festival of Colors', type: 'festival' },
        { date: '2025-04-14', name: 'Good Friday', reason: 'Christian Holiday', type: 'religious' },
        { date: '2025-04-18', name: 'Ram Navami', reason: 'Hindu Festival', type: 'religious' },
        { date: '2025-05-01', name: 'Labour Day', reason: 'International Workers\' Day', type: 'national' },
        { date: '2025-08-15', name: 'Independence Day', reason: 'National Holiday', type: 'national' },
        { date: '2025-08-29', name: 'Janmashtami', reason: 'Hindu Festival', type: 'religious' },
        { date: '2025-10-02', name: 'Gandhi Jayanti', reason: 'National Holiday', type: 'national' },
        { date: '2025-10-31', name: 'Diwali', reason: 'Festival of Lights', type: 'festival' },
        { date: '2025-12-25', name: 'Christmas Day', reason: 'Christian Holiday', type: 'religious' }
      ],
      2024: [
        { date: '2024-01-01', name: 'New Year\'s Day', reason: 'National Holiday', type: 'national' },
        { date: '2024-01-26', name: 'Republic Day', reason: 'National Holiday', type: 'national' },
        { date: '2024-03-25', name: 'Holi', reason: 'Festival of Colors', type: 'festival' },
        { date: '2024-03-29', name: 'Good Friday', reason: 'Christian Holiday', type: 'religious' },
        { date: '2024-04-17', name: 'Ram Navami', reason: 'Hindu Festival', type: 'religious' },
        { date: '2024-05-01', name: 'Labour Day', reason: 'International Workers\' Day', type: 'national' },
        { date: '2024-08-15', name: 'Independence Day', reason: 'National Holiday', type: 'national' },
        { date: '2024-08-26', name: 'Janmashtami', reason: 'Hindu Festival', type: 'religious' },
        { date: '2024-10-02', name: 'Gandhi Jayanti', reason: 'National Holiday', type: 'national' },
        { date: '2024-11-01', name: 'Diwali', reason: 'Festival of Lights', type: 'festival' },
        { date: '2024-12-25', name: 'Christmas Day', reason: 'Christian Holiday', type: 'religious' }
      ],
      2026: [
        { date: '2026-01-01', name: 'New Year\'s Day', reason: 'National Holiday', type: 'national' },
        { date: '2026-01-26', name: 'Republic Day', reason: 'National Holiday', type: 'national' },
        { date: '2026-03-05', name: 'Holi', reason: 'Festival of Colors', type: 'festival' },
        { date: '2026-04-03', name: 'Good Friday', reason: 'Christian Holiday', type: 'religious' },
        { date: '2026-04-06', name: 'Ram Navami', reason: 'Hindu Festival', type: 'religious' },
        { date: '2026-05-01', name: 'Labour Day', reason: 'International Workers\' Day', type: 'national' },
        { date: '2026-08-15', name: 'Independence Day', reason: 'National Holiday', type: 'national' },
        { date: '2026-08-17', name: 'Janmashtami', reason: 'Hindu Festival', type: 'religious' },
        { date: '2026-10-02', name: 'Gandhi Jayanti', reason: 'National Holiday', type: 'national' },
        { date: '2026-10-19', name: 'Diwali', reason: 'Festival of Lights', type: 'festival' },
        { date: '2026-12-25', name: 'Christmas Day', reason: 'Christian Holiday', type: 'religious' }
      ]
    };

    // Toggle calendar popup
    function toggleCalendar() {
      const popup = document.getElementById('calendarPopup');
      const overlay = document.getElementById('calendarOverlay');

      popup.classList.add('show');
      overlay.classList.add('show');

      // Render calendar when opened
      renderCalendar(currentYear);
    }

    // Close calendar popup
    function closeCalendar() {
      const popup = document.getElementById('calendarPopup');
      const overlay = document.getElementById('calendarOverlay');

      popup.classList.remove('show');
      overlay.classList.remove('show');
    }

    // Change year
    function changeYear(direction) {
      currentYear += direction;
      renderCalendar(currentYear);
    }

    // Get holiday by date
    function getHolidayByDate(year, date) {
      const yearHolidays = holidays[year] || [];
      return yearHolidays.find(holiday => holiday.date === date);
    }

    // Render calendar
    function renderCalendar(year) {
      const calendarGrid = document.getElementById('calendarGrid');
      const currentYearEl = document.getElementById('currentYear');
      const holidayYearEl = document.getElementById('holidayYear');

      if (!calendarGrid) return;

      // Clear and update year display
      calendarGrid.innerHTML = '';
      currentYearEl.textContent = year;
      holidayYearEl.textContent = year;

      // Generate calendar for each month
      for (let month = 0; month < 12; month++) {
        const monthDiv = document.createElement('div');
        monthDiv.className = 'month-card';

        const monthName = new Date(year, month).toLocaleDateString('en-US', { month: 'long' });
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const firstDay = new Date(year, month, 1).getDay();

        let calendarHTML = `
          <div class="month-header">${monthName}</div>
          <div class="days-grid">
            <div class="day-header">Su</div>
            <div class="day-header">Mo</div>
            <div class="day-header">Tu</div>
            <div class="day-header">We</div>
            <div class="day-header">Th</div>
            <div class="day-header">Fr</div>
            <div class="day-header">Sa</div>
        `;

        // Add empty cells for days before month starts
        for (let i = 0; i < firstDay; i++) {
          calendarHTML += '<div class="calendar-day"></div>';
        }

        // Add days of the month
        const today = new Date();
        for (let day = 1; day <= daysInMonth; day++) {
          const date = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
          const holiday = getHolidayByDate(year, date);
          const currentDate = new Date(year, month, day);

          let dayClasses = 'calendar-day';
          let dayTitle = '';

          // Check if it's today
          if (
            currentDate.getDate() === today.getDate() &&
            currentDate.getMonth() === today.getMonth() &&
            currentDate.getFullYear() === today.getFullYear()
          ) {
            dayClasses += ' today';
          }

          // Check if it's a holiday
          if (holiday) {
            dayClasses += ` holiday ${holiday.type}`;
            dayTitle = `title="${holiday.name} - ${holiday.reason}"`;
          }

          calendarHTML += `
            <div class="${dayClasses}" ${dayTitle}>
              ${day}
              ${holiday ? '<div class="holiday-indicator"></div>' : ''}
            </div>
          `;
        }

        calendarHTML += '</div>';
        monthDiv.innerHTML = calendarHTML;
        calendarGrid.appendChild(monthDiv);
      }

      // Render holidays list
      renderHolidaysList(year);
    }

    // Render holidays list
    function renderHolidaysList(year) {
      const holidaysList = document.getElementById('holidaysList');
      const holidaySummary = document.getElementById('holidaySummary');

      if (!holidaysList) return;

      const yearHolidays = holidays[year] || [];

      if (yearHolidays.length === 0) {
        holidaysList.innerHTML = '<div class="text-muted">No holidays data available for this year.</div>';
        holidaySummary.innerHTML = '<div class="text-muted">No data</div>';
        return;
      }

      // Group holidays by type
      const holidaysByType = yearHolidays.reduce((acc, holiday) => {
        if (!acc[holiday.type]) acc[holiday.type] = [];
        acc[holiday.type].push(holiday);
        return acc;
      }, {});

      let holidaysHTML = '';
      Object.keys(holidaysByType).forEach(type => {
        const typeCapitalized = type.charAt(0).toUpperCase() + type.slice(1);

        holidaysHTML += `
          <div class="holiday-group">
            <div class="holiday-type-header ${type}">
              ${typeCapitalized} Holidays
            </div>
        `;

        holidaysByType[type].forEach(holiday => {
          const date = new Date(holiday.date);
          const formattedDate = date.toLocaleDateString('en-US', {
            month: 'short',
            day: 'numeric'
          });

          holidaysHTML += `
            <div class="holiday-item ${type}">
              <div>
                <strong>${holiday.name}</strong>
                <div style="font-size: 0.8rem; color: #666;">${holiday.reason}</div>
              </div>
              <div style="font-weight: bold; color: #667eea;">${formattedDate}</div>
            </div>
          `;
        });

        holidaysHTML += '</div>';
      });

      holidaysList.innerHTML = holidaysHTML;

      // Update summary
      const totalHolidays = yearHolidays.length;
      const typeCount = Object.keys(holidaysByType).length;
      const nextHoliday = getNextHoliday(year);

      holidaySummary.innerHTML = `
        <div class="summary-stat">
          <div class="summary-number">${totalHolidays}</div>
          <div class="summary-label">Total Holidays</div>
        </div>
        <div class="summary-stat">
          <div class="summary-number">${typeCount}</div>
          <div class="summary-label">Holiday Types</div>
        </div>
        ${nextHoliday ? `
          <div class="summary-stat">
            <div style="font-size: 0.9rem; font-weight: bold; color: #667eea;">Next Holiday:</div>
            <div style="font-size: 0.8rem;">${nextHoliday.name}</div>
            <div style="font-size: 0.8rem; color: #666;">${new Date(nextHoliday.date).toLocaleDateString()}</div>
          </div>
        ` : ''}
      `;
    }

    // Get next holiday
    function getNextHoliday(year) {
      const yearHolidays = holidays[year] || [];
      const today = new Date().toISOString().split('T')[0];

      return yearHolidays
        .filter(holiday => holiday.date >= today)
        .sort((a, b) => new Date(a.date) - new Date(b.date))[0];
    }

    // Close popup when pressing Escape key
    document.addEventListener('keydown', function (event) {
      if (event.key === 'Escape') {
        closeCalendar();
      }
    });

    // Teacher Background Animation
    function createTeacherParticles() {
      const particlesContainer = document.getElementById('teacherParticles');
      if (!particlesContainer) return;

      const particleCount = 50;

      // Clear existing particles
      particlesContainer.innerHTML = '';

      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';

        // Random position
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = '100vh';

        // Random size
        const size = Math.random() * 3 + 2;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';

        // Random animation delay
        particle.style.animationDelay = Math.random() * 20 + 's';

        // Random animation duration
        particle.style.animationDuration = (Math.random() * 10 + 15) + 's';

        particlesContainer.appendChild(particle);
      }

      // Create new particles periodically
      setTimeout(createTeacherParticles, 5000);
    }

    // Enhanced background effects for teacher
    function initTeacherEffects() {
      const teacherBg = document.querySelector('.teacher-bg');
      if (!teacherBg) return;

      // Add mouse movement effect
      document.addEventListener('mousemove', function (e) {
        const x = (e.clientX / window.innerWidth) * 100;
        const y = (e.clientY / window.innerHeight) * 100;

        teacherBg.style.backgroundPosition = `${x}% ${y}%`;
      });

      // Add click ripple effect
      teacherBg.addEventListener('click', function (e) {
        const ripple = document.createElement('div');
        ripple.style.position = 'absolute';
        ripple.style.borderRadius = '50%';
        ripple.style.background = 'rgba(255, 255, 255, 0.3)';
        ripple.style.transform = 'scale(0)';
        ripple.style.animation = 'ripple 0.6s linear';
        ripple.style.left = (e.clientX - 25) + 'px';
        ripple.style.top = (e.clientY - 25) + 'px';
        ripple.style.width = '50px';
        ripple.style.height = '50px';
        ripple.style.pointerEvents = 'none';
        ripple.style.zIndex = '999';

        this.appendChild(ripple);

        setTimeout(() => {
          ripple.remove();
        }, 600);
      });

      // Create floating icons
      createFloatingIcons();
    }

    function createFloatingIcons() {
      const teacherBg = document.querySelector('.teacher-bg');
      if (!teacherBg) return;

      const icons = ['📚', '✏️', '🎓', '📝', '🏫', '📊'];

      icons.forEach((icon, index) => {
        const iconElement = document.createElement('div');
        iconElement.textContent = icon;
        iconElement.style.position = 'absolute';
        iconElement.style.fontSize = '2rem';
        iconElement.style.opacity = '0.3';
        iconElement.style.pointerEvents = 'none';
        iconElement.style.zIndex = '2';
        iconElement.style.left = Math.random() * 90 + '%';
        iconElement.style.top = Math.random() * 90 + '%';
        iconElement.style.animation = `iconFloat 8s ease-in-out infinite ${index * 1.5}s`;

        teacherBg.appendChild(iconElement);
      });
    }

    // Add ripple animation CSS
    const rippleStyle = document.createElement('style');
    rippleStyle.textContent = `
      @keyframes ripple {
        to {
          transform: scale(4);
          opacity: 0;
        }
      }
      
      @keyframes iconFloat {
        0%, 100% { 
          transform: translateY(0px) rotate(0deg);
          opacity: 0.3;
        }
        50% { 
          transform: translateY(-20px) rotate(180deg);
          opacity: 0.6;
        }
      }
    `;
    document.head.appendChild(rippleStyle);

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function () {
      // Initialize teacher effects
      initTeacherEffects();

      // Start particle animation for teacher background
      createTeacherParticles();

      // Add smooth entrance animation for teacher container
      const teacherContainer = document.querySelector('.teacher-container');
      if (teacherContainer) {
        teacherContainer.style.opacity = '0';
        teacherContainer.style.transform = 'translateY(30px)';

        setTimeout(() => {
          teacherContainer.style.transition = 'all 1s ease';
          teacherContainer.style.opacity = '1';
          teacherContainer.style.transform = 'translateY(0)';
        }, 300);
      }
    });

    // Service Worker and PWA Install Prompt
    let deferredPrompt;
    const pwaInstallBanner = document.getElementById('pwaInstallBanner');

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/static/sw.js')
          .then((registration) => {
            console.log('SW registered: ', registration);
          })
          .catch((registrationError) => {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }

    // PWA Install Banner Logic
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      // Show install banner after 3 seconds
      setTimeout(() => {
        pwaInstallBanner.classList.add('show');
      }, 3000);
    });

    // Install PWA when banner is clicked
    pwaInstallBanner.addEventListener('click', (e) => {
      if (e.target.classList.contains('close-btn')) return;
      
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the install prompt');
          }
          deferredPrompt = null;
          pwaInstallBanner.classList.remove('show');
        });
      }
    });

    // Close PWA install banner
    function closePwaInstallBanner() {
      pwaInstallBanner.classList.remove('show');
    }
  </script>

  <!-- Floating Chatbot Button -->
  <a href="/chatbot" class="chatbot-button" target="_blank" rel="noopener noreferrer" title="Open Attendance Assistant">
    <i class="fas fa-comments"></i>
    💬 Chatbot Assistant
  </a>
</body>

</html>